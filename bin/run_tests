total=0
passed=0
failed=0

for test in `ls -d */ | egrep '^[0-9]{2}_.*'`
do
  echo "Testing: $test"
  total=$(( $total + 1 ))
  result=`(cd $test ; gen_dot config* ; cmp --silent expected.gv config*.gv) || echo 'fail'`
  if [[ $result == 'fail' ]]
  then
    failed=$(( $failed + 1 ))
    echo "  Fail"
  else
    passed=$(( $passed + 1 ))
    echo "  Pass"
  fi
  `cd $test ; rm config*.gv`
done

echo "Tests: $passed passed, $failed failed, $total total"
