param_files=$(parameter_files $1)


if [[ -z "$param_files" ]]
then
  echo "No parameter files in '$1'."
  exit 1
fi

OUTPUT=false
INPUT=false
PARAM=false

while read -ra line; do
	for p in "${line[@]}";
	do
		if [[ $p == inputfile ]]
		then
			INPUT=true
		elif [[ $p == outputfile ]]
		then
			OUTPUT=true	
			INPUT=$p
		elif [[ $INPUT == true ]]
		then
			#test to see if input file is param file
			PARAM=$(grep $p $param_files)
			if [[ -z "$PARAM" ]]
			then
			  exit 1
			fi	
			INPUT=false		
		elif [[ $OUTPUT == true ]]
		then
			printf "$p\n"
			OUTPUT=false
		fi
	done;
done <$1

